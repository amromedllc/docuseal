<% if current_user.created_at > 2.weeks.ago || params[:tour] == 'true' %>
  <% user_config = current_user.user_configs.find_or_initialize_by(key: UserConfig::SHOW_APP_TOUR) %>
  <% @show_tour_start_form = user_config.new_record? && !params.key?(:tour) %>
  <% if user_config.new_record? || user_config.value || params[:tour] == 'true' %>
    <app-tour data-show-tour="<%= params[:tour] == 'true' || user_config.value %>" data-type="builder" data-next-page-path="<%= template_path(@template, params.permit(:tour)) %>" data-i18n="<%= t('app_tour').to_json %>"></app-tour>
    <%= button_to nil, user_configs_path, method: :post, params: { user_config: { key: UserConfig::SHOW_APP_TOUR, value: true } }, class: 'hidden', id: 'start_tour_button' %>
  <% end %>
<% end %>
<% predefined_fields = [
  { name: 'units', type: 'number', title: 'Units' },
  { name: 'schedule_date', type: 'date', title: 'Schedule Date' },
  { name: 'from_time', type: 'text', title: 'From Time' },
  { name: 'to_time', type: 'text', title: 'To Time' },
  { name: 'place_of_service', type: 'text', title: 'Place of Service' },
  { name: 'time_duration', type: 'text', title: 'Time Duration' },
  { name: 'supervisor_name', type: 'text', title: 'Supervisor Name' },
  { name: 'provider_npi', type: 'text', title: 'Provider NPI' },
  { name: 'provider_name', type: 'text', title: 'Provider Name' },
  { name: 'provider_credential_type', type: 'text', title: 'Provider Credential Type' },
  { name: 'patient_name', type: 'text', title: 'Patient Name' },
  { name: 'patient_first_name', type: 'text', title: 'Patient First Name' },
  { name: 'patient_last_name', type: 'text', title: 'Patient Last Name' },
  { name: 'patient_gender', type: 'text', title: 'Patient Gender' },
  { name: 'patient_dob', type: 'date', title: 'Patient DOB' },
  { name: 'patient_address', type: 'text', title: 'Patient Address' },
  { name: 'patient_phone', type: 'text', title: 'Patient Phone' },
  { name: 'patient_initials', type: 'initials', title: 'Patient Initials' },
  { name: 'patient_age', type: 'number', title: 'Patient Age' },
  { name: 'patient_language', type: 'text', title: 'Patient Language' },
  { name: 'patient_parent_name', type: 'text', title: 'Patient Parent Name' },
  { name: 'patient_first_seen_date', type: 'date', title: 'Patient First Seen Date' },
  { name: 'payor_name', type: 'text', title: 'Payor Name' }
] %>
<template-builder class="grid" data-template="<%= @template_data %>" data-with-sign-yourself-button="<%= !@template.archived_at? %>" data-with-fields-detection="true" data-with-send-button="<%= !@template.archived_at? && can?(:create, @template.submissions.new(account: current_account)) %>" data-locale="<%= I18n.locale %>" data-show-tour-start-form="<%= @show_tour_start_form %>" data-predefined-fields="<%= predefined_fields.to_json %>"></template-builder>